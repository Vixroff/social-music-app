{% extends "base.html" %}

{% block content %}
<h1>Плейлист: {{ playlist.name }}</h1>
<p>Создатель: {{ playlist.creator }}</p>
<p>Создан: {{ playlist.created_at }}</p>

<h2>Треки</h2>
{% for track in tracks %}
<p>
    Трек "{{ track.name }}" ({{ track.author }})
</p>
{% endfor %}

{% if request.user.is_authenticated %}
    <form method="post" action="{% url 'playlist' pk=playlist.id %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" name="add_comment">Отправить</button>
    </form>
{% endif %}
<h3>Комментарии</h3>
{% if comments %}
    {% for comment in comments %}
    <div>
        <h4>Комментарий пользователя {{ comment.author }}</h4>
        <p>{{ comment.message }}</p>
        <span>{{ comment.created_at }}</span>
        {% if request.user == comment.author or request.user == playlist.creator %}
        <form method="post" action="{% url 'playlist' pk=playlist.id %}">
            {% csrf_token %}
            <input type="hidden" name="comment_id" value="{{ comment.id }}">
            <button type="submit" name="delete_comment">Удалить</button>
        </form>
        {% endif %}
    </div>
    {% endfor %}
{% else %}
    <p>Комментарии отсутствуют </p>
{% endif %}

{% endblock %}